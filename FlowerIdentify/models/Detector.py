import torch
from PIL import Image
from torchvision import transforms
from models.cct import cct_14_7x2_384_fl
class Detector():
    def __init__(self):
        # self.device = torch.device("cuda" if torch.cuda.is_available() else "cpu")
        self.device = torch.device("cpu")
        mean = [0.4353, 0.3773, 0.2872]
        std = [0.2966, 0.2455, 0.2698]
        img_size = 384
        self.transform = transforms.Compose([
            transforms.Resize((img_size,img_size)),
            transforms.ToTensor(),
            transforms.Normalize(mean=mean, std=std)
        ])
        # 识别阈值，低于此阈值表示不在识别范围内
        self.threshold = 0.6
        self.model = cct_14_7x2_384_fl(pretrained=True, progress=True).to(self.device)
        self.model.eval()

        self.flower_name = {'21':[' fire lily ','火百合','火百合是龙舌兰科茅花属的多年生植物，是澳大利亚东部的特有种。我国热带地区引种栽培。'],
                            '3':[' canterbury bells ','风铃草','风铃草是桔梗科、风铃草属二年生宿根草本植物，株高50-120厘米；茎粗壮直立，基生。叶簇生，卵形至倒卵形；小花1-2朵聚生成总状花序，花冠钟形，长约6厘米，有白、蓝或紫等色；蒴果，带有宿存的花萼裂片；种子多数，椭圆状，平滑。花期5-6月。'],
                            '45':[' bolero deep blue ','洋桔梗','洋桔梗（Eustoma russellianum）又名草原龙胆，为龙胆科龙胆属观赏植物。洋桔梗为1～2年生草本，茎直立，灰绿色，卵状或长椭圆形叶对生，叶片灰绿色，原产北美洲，是近年逐渐流行的一种高档切花。洋桔梗有单瓣品种和重瓣品种两大类，花冠呈美丽的杯状或钟状，颜色有白色、粉红色、橘红色、紫色、蓝色及复色等。'],
                            '1':[' pink primrose ','红花月见草','红花月见草（Oenothera speciosa），又称粉花月见草、待霄草、粉晚樱草，是月见草的一种。多年生草本，具粗大主根，茎常丛生，基生叶紧贴地面，倒披针形，花期4-11月，果期9-12月。原产美国得克萨斯州南部和墨西哥，生于海拔1000-2000米荒地草地、沟边半阴处，繁殖力强。根入药，有消炎、降血压功效。'],
                            '34':[' mexican aster ','墨西哥紫苑','菊科植物。树高是1-4英尺，树幅是2至3英尺，六月到霜冻开花，养护成本低。'],
                            '27':[' prince of wales feathers ','Celosia argentea','学名Celosia argentea,树高是1-1.50英尺，树幅是0.75至1英尺，六月到霜冻开花，养护成本低。'],
                            '7':[' moon orchid ','鹤望兰','鹤望兰（Strelitzia reginae Aiton）芭蕉科鹤望兰亚科 [1]  多年生草本植物，无茎。叶片长圆状披针形，长25-45cm，宽10cm。叶片顶端急尖；叶柄细长。花数朵生于总花梗上，下托一佛焰苞；佛焰苞绿色，边紫红，萼片橙黄色，花瓣暗蓝色；雄蕊与花瓣等长；花药狭线形，花柱突出，柱头3。花期在冬季。'],
                            '16':[' globe-flower ','金莲花','金莲花（学名：Trollius chinensis Bunge），别名：旱地莲、金梅草、金疙瘩，是毛茛科金莲花属的植物。多年生草本，茎高30-70厘米，不分枝。花单独顶生或2-3朵组成稀疏的聚伞花序，直径3.8-5.5厘米；花梗长5-9厘米；苞片三裂；萼片(6-)10-15(-19)片，金黄色；花瓣18-21个，狭线形，顶端渐狭，长1.8-2.2厘米，宽1.2-1.5毫米。6-7月开花，8-9月结果。'],
                            '25':[' grape hyacinth ','麝香兰 ','（葡萄）麝香兰。又名葡萄风信子、葡萄水仙、葡萄百合、蓝壶花、蓝瓶花。百合科麝香兰属多年生小球根植物，约50种。原产于地中海地区。多数品种的花密集簇生于无叶花葶顶端，呈花坛状，颜色有蓝色、白色或粉红色。部分种有麝香味。春天开花，常被栽培为花园观赏植物。'],
                            '26':[' corn poppy ','丽春花 ','丽春花又名仙女蒿、虞美人、赛牡丹，系罂粟科一、二年生宿根草本。'],
                            '79':[' toad lily ',' 蟾蜍百合 ','蟾蜍百合外观十分奇特，花朵上面有着大量的斑点，看起来却异常的美丽，是一种令人赏心悦目的花'],
                            '39':[' siam tulip ','姜黄','姜黄属（学名：Curcuma）是姜科下的一个属，为多年生草本植物[3]。常见的植物有姜黄及姜荷花。'],
                            '24':[' red ginger ',' 红姜','紫花山姜（学名：Alpinia purpurata (Vieill.) K.Schum）：是多年生草本植物。具根状茎，通常具发达的地上茎，高1.2-1.8米。叶片长圆形，长30-80厘米，宽10-22厘米，无毛。花序顶生在多叶嫩枝上，不分枝，总状花序。花萼管状，带红色，唇瓣比花冠裂片大，显著，常有美丽的色彩，颜色为粉红、玫瑰、紫红色、洋红、粉紫色、红色。有时顶端2裂。蒴果肉质，近球形，通常不规则开裂；种子3毫米长，多数，有假种皮，成角。'],
                            '67':[' spring crocus ',' 藏红花;黄色藏红花 ','番红花（学名：Crocus sativus L.）又称藏红花、西红花，是一种鸢尾科番红花属的多年生花卉，也是一种常见的香料。多年生草本。球茎扁圆球形，直径约3厘米，外有黄褐色的膜质包被。叶基生，9-15枚，条形，灰绿色，边缘反卷；叶丛基部包有4-5片膜质的鞘状叶。花茎甚短，不伸出地面；花1-2朵，淡蓝色、红紫色或白色，有香味，花柱橙红色，柱头略扁，顶端楔形，有浅齿，子房狭纺锤形。蒴果椭圆形，长约3厘米。'],
                            '35':[' alpine sea holly ','海冬青','海冬青(Eryngium Maritimum) ，又名“滨海刺芹”，属伞形科和刺芹属植物，是一种欧洲原生的海岸植物，生长于布列塔尼海岸沙地。极端的环境让这种植物在进化中逐渐发展为生命力极其强大的盐生植物。'],
                            '32':[' garden phlox ',' 草夹竹桃 ','草夹竹桃是一种耐寒草本植物，成簇的花朵，外形小而色彩鲜艳。草夹竹桃与吉莉草（gilia）是同一属植物。草夹竹桃是最受人们欢迎的园艺植物，多被用于妆点路边花坛或假山'],
                            '10':[' globe thistle ',' 球蓟 ',' 球蓟(Cfnara 5colymusl )，又名菜蓟或朝鲜蓟，是菊科多 年生植物，原产欧洲地中海地区。球蓟株高lm一2m，叶片羽 状深裂，浓绿上举，似古代战戟。'],
                            '6':[' tiger lily ','卷丹','卷丹（学名：Lilium lancifolium Thunb.）：卷丹花瓣有平展的，有向外翻卷的，故有“卷丹”美名。鳞茎近宽球形，高约3.5厘米，直径4-8厘米；鳞片宽卵形，长2.5-3厘米，宽1.4-2.5厘米，白色。茎高0.8-1.5米，带紫色条纹，具白色绵毛。叶散生，矩圆状披针形或披针形，两面近无毛，有5-7条脉。花3-6朵或更多；苞片叶状，卵状披针形；花下垂，花被片披针形，反卷，橙红色，有紫黑色斑点。蒴果狭长卵形，长3-4厘米。花期7-8月，果期9-10月。'],
                            '93':[' ball moss ','苔藓球','苔藓球（学名：Tillandsia recurvata (L.) L.）是凤梨科、铁兰属植物。'],
                            '33':[' love in the mist ','雾中恋花','一种迷人的老式花卉，在春季和初夏盛开。属名Nigella来自拉丁语niger（黑色），指的是浓郁的黑色种子。大马士革猪笼草是毛茛科（毛茛科）该属的约 15 个物种之一，来自南欧和北非。在其原生栖息地，它生长在田野、路边、岩石或荒地上。'],
                            '9':[' monkshood ',' 川乌 ','川乌，正名为乌头（学名：Aconitum carmichaelii / Radix ），别名：鹅儿花、铁花、五毒；被子植物门，毛茛科，乌头属。 [1]  川乌为乌头的母根，外观呈圆锥形，顶端多有残存茎基，根中部多向一边膨大；表面颜色呈灰棕色或者棕褐色，可见有小瘤状侧根呈突起状（习称为“钉角”），子根脱离在母根表面留有痕迹；川乌质地坚实，断面呈类白色或者浅灰黄色，形成层环多呈多角形；闻之气微，嚼之味辛辣麻舌。'],
                            '102':[' blackberry lily ',' 黑莓百合 ','黑莓百合（有时也称为豹纹百合）实际上是鸢尾属植物的一种，而不是百合。它是一种丛生植物，由蔓延的根茎生长而成，扁平的带状叶子长达 10 英寸。在仲夏至夏末，细长的茎高达 4 英尺，开出六片花瓣的亮橙色、带红色斑点的花朵。花朵被梨形种子荚取代，这些种子荚在夏末开放，露出类似黑莓的种子簇（通用名称的来源）。'],
                            '14':[' spear thistle ',' 矛蓟 ','矛蓟是一种常见的扰动地面植物，如路边和田野边缘，夏季出现紫色、蓬松的花头。它的花吸引昆虫，它的种子喂鸟。'],
                            '19':[' balloon flower ','桔梗','桔梗（Platycodon grandiflorus），别名包袱花、铃铛花、僧帽花，是多年生草本植物，茎高20～120厘米，通常无毛，偶密被短毛，不分枝，极少上部分枝。叶全部轮生，部分轮生至全部互生，无柄或有极短的柄，叶片卵形，卵状椭圆形至披针形，花暗蓝色或暗紫白色，可作观赏花卉；'],
                            '100':[' blanket flower ',' 宿根天人菊 ','宿根天人菊（学名：Gaillardia aristata Pursh.）是菊科天人菊属多年生草本植物，高60-100厘米，全株被粗节毛。茎不分枝或稍有分枝。基生叶和下部茎叶长椭圆形或匙形；中部茎叶披针形、长椭圆形或匙形。舌状花黄色；管状花外面有腺点，裂片长三角形，顶端芒状渐尖，被节毛。瘦果长2毫米，被毛。花果期7-8月。'],
                            '13':[' king protea ',' 帝王花 ','帝王花（Protea cynaroides），又名普蒂亚花，是南非共和国的国花。其花朵硕大、花形奇特、瑰丽多彩、高贵优雅，号称“花中之王”。久开不败的帝王花，被誉为全世界最富贵华丽的鲜花，代表着旺盛而顽强的生命力，并象征着胜利、圆满与吉祥。'],
                            '49':[' oxeye daisy ','春白菊 ','春白菊是一种多年生的草本花卉，它的植株高度在60-100公分，花瓣洁白管状花充是黄色，每年的五六月份开花。春白菊喜欢光照充足、气候温暖的的生长环境，它也比较的耐寒、耐旱，但不耐荫、怕水涝，在土壤肥沃的生长环境下能够长得更好。'],
                            '15':['yellow iris ',' 黄菖蒲 ','黄菖蒲（学名：Iris pseudacorus L.）是鸢尾科鸢尾属植物，是多年生湿生或挺水宿根草本植物，植株高大，根茎短粗。叶子茂密，基生，绿色，长剑形，长60-100厘米，中肋明显，并具横向网状脉。花茎稍高出于叶，垂瓣上部长椭圆形，基部近等宽，具褐色斑纹或无，旗瓣淡黄色，花径8厘米。蒴果长形，内有种子多数，种子褐色，有棱角。花期5-6月份。'],
                            '61':['cautleya spicata ','红苞距药姜','红苞距药姜（学名：Cautleya spicata）为姜科距药姜属下的一个种。'],
                            '31':['carnation ','康乃馨 ','康乃馨（学名：Dianthus Carnation）：是石竹科、石竹属多年生草本植物，是多种石竹属园艺品种的通称。为多年生草本植物，株高70-100厘米，基部半木质化。整个植株被有白粉，呈灰绿色。茎干硬而脆，节膨大。叶线状披针形，全缘，叶质较厚，上半部向外弯曲，对生，基部抱茎。花通常单生，聚伞状排列。花冠半球形，花萼长筒状，花蕾橡子状，花瓣扇形，花朵内瓣多呈皱缩状，花色有大红、粉红、鹅黄、白、深红等，还有玛瑙等复色及镶边等，有香气。'],
                            '64':['silverbush ','银灌木','作为常绿灌木,它长着如丝般光滑的银灰色长矛状叶子。暮春时节，牵牛花开得像花。它们通常是白色的，但很少是粉红色的；他们有一个显着的黄色喉咙。'],
                            '68':['bearded iris ',' 有髯鸢尾 ','有髯鸢尾，杂交种，多年生草本。人们把垂瓣上有髯毛附属物的鸢尾统称为有髯鸢尾，有髯鸢尾不仅外花瓣中肋上具有色泽多变的细密髯毛状附属物，还具有花大、花形奇特、花色艳丽等特性。'],
                            '63':['black-eyed susan ','金光菊 ','金光菊（学名：Rudbeckia laciniata L.）：又名黑眼菊、黄菊、黄菊花、假向日葵等，属桔梗目、菊科多年生草本，茎无毛或稍有短糙毛。叶互生，无毛或被疏短毛。头状花序单生于枝端，具长花序梗。总苞半球形；花托球形；舌状花金黄色；舌片倒披针形；管状花黄色或黄绿色。瘦果无毛，稍有4棱。花期7-10月。'],
                            '69':['windflower ',' 银莲花','银莲花（Anemone cathayensis Kitag）是毛茛科、银莲花属植物。多年生草本。基生叶4-8；叶片圆肾形，两面疏生柔毛或变无毛，3全裂，中央裂片宽菱形或菱状倒卵形，3裂近中部；叶柄疏被长柔毛或变无毛。花葶高17-40厘米；总苞苞片约5，无柄，不等大，菱形或倒卵形，3裂或不分裂；伞形花序简单；花梗长3.5-5厘米；萼片5-6，白色或带粉红色，倒卵形，长1.5-2厘米；无花瓣；雄蕊多数，花丝条形；心皮无毛。瘦果扁平，宽椭圆形或近圆形，长约5毫米，宽4-5毫米。'],
                            '62':['japanese anemone ',' 秋牡丹 ','秋牡丹（学名：Anemone hupehensis Lem. var.japonica (Thunb.) Bowles et Stearn）别名是野棉花。是毛茛科，银莲花属多年生草本植物，株高可达120厘米。根状茎斜或垂直，基生叶有长柄，小叶片卵形或宽卵形，边缘有锯齿，两面有疏糙毛；花葶直立，聚伞花序，有较多花，苞片有柄为三出复叶，似基生叶；花梗有密或疏柔毛；萼片紫红色或粉红色，倒卵形，花药黄色，椭圆形，花丝丝形；聚合果球形，7月至10月开花。'],
                            '20':['giant white arum lily ','马蹄莲','一种半常绿、丛生的多年生植物，高 2 米，叶子大，有光泽，略带褶皱，有白色斑点，深绿色。从夏季到初秋，大而漏斗状的白色佛焰苞生长在叶子上方的直立茎上'],
                            '38':['great masterwort ','麦芽草','麦芽草植物，也被称为海蒂针垫，不仅有独特的花朵，而且恰好是少数在阴凉处茁壮成长的切花之一。这就是为什么这种华丽的植物非常适合那些没有充足阳光但仍希望花园里有流行色彩的人。'],
                            '4':[' sweet pea ',' 香豌豆 ','香豌豆（学名：Lathyrus odoratus L.）是豆科山黧豆属植物，一年生草本，高50-200厘米，全株或多或少被毛。茎攀缘，多分枝，具翅。叶具1对小叶，托叶半箭形；叶轴具翅，叶轴末端具有分枝的卷须；小叶卵状长圆形或椭圆形，长2-6厘米，宽0.7-3厘米。总状花序长于叶，具1-3（-4）朵花，长于叶。荚果线形有时稍弯曲，长5-7厘米，宽1-1.2厘米，棕黄色，被短柔毛。种子平滑，种脐为周圆的1/4。花果期6-9月。'],
                            '86':[' tree mallow ',' 花葵 ','花葵（学名：Lavatera arborea L.）是锦葵科、花葵属植物。二年生草本，高1-3米；枝带木质化，被软柔毛。叶肾形，5-9裂，长7-20厘米，宽近于相等，边缘具钝齿，两面均具软毛。花序排列成顶生总状花序，或1-4朵生于叶腋间，花梗长2-2.5厘米；被短柔毛，近端处有节；小苞片3枚，叶状，全缘，长1厘米，宽1.4厘米；萼片小，锐尖，长为小苞片的1/3；花冠暗紫红色，基部具深紫色脉，直径4-5厘米；雄蕊柱被硬毛，子房具心皮7。蒴果直径约1厘米，无毛，成熟心皮平滑，花柱基部膨大，圆锥状，直径约1.5毫米。'],
                            '101':[' trumpet creeper ',' 凌霄花属 ','凌霄（学名：Campsis grandiflora (Thunb.) Schum.）是紫葳科、凌霄属攀援藤本植物。茎木质，表皮脱落，枯褐色，以气生根攀附于它物之上；叶对生，为奇数羽状复叶；小叶7-9枚，卵形至卵状披针形，侧脉6-7对，两面无毛，边缘有粗锯齿；叶轴长4-13厘米；小叶柄长5（-10）毫米；顶生疏散的短圆锥花序，花序轴长15-20厘米；花萼钟状，长3厘米；花冠内面鲜红色，外面橙黄色，长约5厘米，裂片半圆形；雄蕊着生于花冠筒近基部；花柱线形，长约3厘米；蒴果细长如豆荚，先端钝，每果含种子数粒。花期5-8月。'],
                            '42':[' daffodil ',' 黄水仙(威尔士的民族象征) ','黄水仙（学名：Narcissus pseudonarcissus L.）：是石蒜科水仙属的植物，为多年生草本。叶绿色，略带灰色，基生，宽线形，先端钝。有皮鳞茎卵圆形，鳞茎最大者长0.45米，宽0.1米。花茎挺拔，顶生1花，花朵硕大，花横向或略向上开放，外花冠呈喇叭形、花瓣淡黄色，边缘呈不规则齿状皱榴。副花冠多变，花色温柔和谐，清香诱人，花期3-4月。是世界著名的球根花卉。'],
                            '22':[' pincushion flower ',' 针垫花 ','针垫花（学名：Leucospermum nutans R.Br.）是山龙眼科、针垫花属常绿灌木。主干直立。叶无柄、簇生，叶片心脏形，全缘，革质。头状花序具苞片，单生或少数聚生，小花冠筒状，裂片2-4枚，雄蕊花丝长，淡红色，顶端白色。坚果白色。'],
                            '2':[' hard-leaved pocket orchid ','硬叶袖珍兰花','硬叶袖珍兰花 (Paphiopedilum micranthum) 通常被称为银拖鞋兰花或袖珍兰花。它在冬末至夏初开花，每个花序开一朵花。'],
                            '54':[' sunflower ',' 向日葵','向日葵（学名：Helianthus annuus L.；英文名：Sunflowers）：是桔梗目、菊科、向日葵属的植物。因花序随太阳转动而得名。一年生草本，高1-3.5米，最高可达9米。茎直立，圆形多棱角，质硬被白色粗硬毛。'],
                            '66':[' osteospermum ',' 蓝眼菊','蓝眼菊（Osteospermum）是菊科金盏花族下的一个属。叶片多对生，耐寒品种叶片为披针形，半耐寒品种叶片椭圆形或披针形，叶缘有锯齿。叶色多为绿色，也有少量品种叶片具彩斑。头状花序单生于茎顶或组成聚伞花序。花盘中心通常为蓝色、黄色、紫色等，一些耐寒性强的品种花盘中心呈深蓝色。'],
                            '70':[' tree poppy ',' 树罂粟 ','该属植物含白屈菜红碱和血根碱等物质。含白屈菜红碱植物如服用可引起呕吐、腹痛、腹泻和嗜睡。血根碱与流行性水肿有关，并可能损伤肝脏，外用会毁容。任何人使用树罂粟都有风险。'],
                            '85':[' desert-rose ','沙漠玫瑰','沙漠玫瑰（Adenium obesum）是一种生长缓慢的植物，每年仅生长约 12 英寸。沙漠玫瑰经常被用作盆景植物，这要归功于其厚实多汁的树干、薄而精致的叶子和甜美的深粉红色喇叭花。它原产于非洲、中东和马达加斯加。'],
                            '99':[' bromelia ','凤梨 ','凤梨（学名：Ananas comosus (Linn.) Merr.），俗称菠萝，为著名热带水果之一。其植株茎短，叶多数，莲座式排列，剑形，顶端渐尖，全缘或有锐齿，腹面绿色，背面粉绿色，边缘和顶端常带褐红色，生于花序顶部的叶变小，常呈红色。花序于叶丛中抽出，状如松球；苞片基部绿色，上半部淡红色，三角状卵形；萼片宽卵形，肉质，顶端带红色；花瓣长椭圆形，端尖，上部紫红色，下部白色。聚花果肉质。花期夏季至冬季。'],
                            '87':[' magnolia ','木兰','木兰（拉丁学名：Magnolia liliflora Desr），是木兰目木兰科木兰属下的植物，为落叶乔木，木兰原产中国中部山地混交林内和山地林中，海拔700-1800米的山坡杂木林中'],
                            '5':[' english marigold ',' 英国万寿菊 ','万寿菊（Tagetes erecta L.）为菊科万寿菊属一年生草本植物，茎直立，粗壮，具纵细条棱，分枝向上平展。叶羽状分裂；沿叶缘有少数腺体。头状花序单生；总苞杯状，顶端具齿尖；舌状花黄色或暗橙色；管状花花冠黄色。瘦果线形，基部缩小，黑色或褐色，被短微毛；冠毛有1-2个长芒和2-3个短而钝的鳞片。花期7-9月。'],
                            '92':[' bee balm ','香蜂草','香蜂草属，唇形科一属。含12种，称为香柠檬、马薄荷和香蜂草。原产北美，现广泛栽培。'],
                            '28':[' stemless gentian ','无茎龙胆','无茎龙胆，但这种常年充满个性的岩石花园也被称为喇叭龙胆。在过去，Clusius 的龙胆 (Gentiana clusii) 这个名称也被用作同义词，今天这两个物种被单独列出。它们被认为是替代物种，彼此非常相似，但发生在地理上不同的区域。虽然 Gentiana clusii 仅出现在石灰石上，但 Gentiana acaulis 具有钙化作用。它的自然分布范围是海拔 800 至 3,000 米（2,626 至 9,840 英尺）之间的阿尔卑斯山、汝拉山脉、塞文山脉和比利牛斯山脉。'],
                            '97':[' mallow ',' 锦葵 ','锦葵（学名：Malva sinensis Cavan.）：二年生或多年生直立草本，高50-90厘米，分枝多，疏被粗毛。叶圆心形或肾形，具5-7圆齿状钝裂片，两面均无毛或仅脉上疏被短糙伏毛。花3-11朵簇生，小苞片3，长圆形疏被柔毛；花紫红色或白色，直径3.5-4厘米，花瓣5，匙形，长2厘米，先端微缺，爪具髯毛。果扁圆形，分果爿9-11，肾形，被柔毛；种子黑褐色，肾形，长2毫米。花期5-10月。'],
                            '57':[' gaura ',' 山桃草属 ','山桃草（学名：Gaura lindheimeri Engelm. et Gray）是柳叶菜科、山桃草属植物。多年生宿根草本。高60-100厘米，叶无柄，椭圆状披针形或倒披针形，花期晚春至初秋；多花型，花蕾白色略带粉红，初花白色，谢花时浅粉红。花紫红色，成密生的穗状花序，花序较长。花期5-8月，果期8-9月。'],
                            '40':[' lenten rose ','四旬期玫瑰','四旬期玫瑰（Helleborus x hybridus）为遮荫花园或归化区增添了美妙的色彩，其开花时间预示着春天的开始。它们在覆盖整个南卡罗来纳州的 USDA 耐寒区 4-9 中生长良好，即使对于初学者来说也是一个绝佳的选择。'],
                            '47':[' marigold ',' 万寿菊;金盏花 ','万寿菊（Tagetes erecta L.）为菊科万寿菊属一年生草本植物，茎直立，粗壮，具纵细条棱，分枝向上平展。叶羽状分裂；沿叶缘有少数腺体。头状花序单生；总苞杯状，顶端具齿尖；舌状花黄色或暗橙色；管状花花冠黄色。瘦果线形，基部缩小，黑色或褐色，被短微毛；冠毛有1-2个长芒和2-3个短而钝的鳞片。花期7-9月。'],
                            '59':[' orange dahlia ','橙色大丽花','大丽花（Dahlia pinnata Cav.），别名大理花、天竺牡丹、东洋菊、大丽菊、地瓜花，菊科、大丽花属植物，多年生草本，有巨大棒状块根。茎直立，多分枝，高1.5-2米，粗壮。原产于墨西哥，墨西哥人把它视为大方、富丽的象征，因此将它尊为国花。'],
                            '48':[' buttercup ',' 毛茛(野生植物，开杯状有光泽的小黄花) ','毛茛（学名：Ranunculus japonicus Thunb.）是毛茛科，毛茛属多年生草本植物。须根多数簇生。茎直立，高可达70厘米，叶片圆心形或五角形，基部心形或截形，中裂片倒卵状楔形或宽卵圆形或菱形，两面贴生柔毛，叶柄生开展柔毛。裂片披针形，有尖齿牙或再分裂；聚伞花序有多数花，疏散；花贴生柔毛；萼片椭圆形，生白柔毛；花瓣倒卵状圆形，花托短小，无毛。聚合果近球形，瘦果扁平，4月至9月花果期。'],
                            '55':[' pelargonium ',' 天竺葵','天竺葵属（学名：Pelargonium LHér. ex Aiton）是牻牛儿苗科下的一属。草本、亚灌木或灌木，具浓烈香气。茎略呈肉质。叶对生或互生；叶片圆形、肾圆形或扇形，不分裂或掌状分裂。边缘波状，具齿。花序通常为伞形或聚伞花序，稀为花单生，总花梗腋生或与叶对生；具苞片；雄蕊10，花丝基部通常合生或偏生，其中1-3枚无药或花药发育不全；子房合生，5心皮，5室，每室具2枚胚珠，花柱分枝5。蒴果具喙，5裂，成熟时果瓣由基部向上卷曲，附于喙的顶端，每室具1种子。种子无胚乳。包于两子叶之间。'],
                            '36':[' ruby-lipped cattleya ','卡特兰','兰花、胸花兰或猫兰的皇后是兰科植物中的一种热带附生植物。它原产于热带新世界，美国农业部 10 至 12 区，从哥斯达黎加到阿根廷。Cattleya 在 1800 年代被狂热而鲁莽地收集，现在已列入 CITES 附录 II。所有出售的卡特兰现在都应该在温室中生产。附生植物生长在高大的丛林树的树枝上，其肉质根茎缠绕在树枝上以保持稳定。它从根茎周围聚集的空气、水和腐烂的植物物质中获取养分。所有这些使得在家里种植有点棘手——非常特殊的快速排水土壤、高湿度、非常特殊的光照要求、丛林温度。然而，Cattleya 是最容易种植的兰花之一。'],
                            '91':[' hippeastrum ',' 朱莲花','朱顶红（学名：Hippeastrum rutilum）又名红花莲，是石蒜科朱顶红属的多年生草本。'],
                            '29':[' artichoke ',' 洋蓟，球蓟(圆形蔬菜，绿色厚叶基部及茎内部均可食用) ','洋蓟原产地中海西部和中部地区，在古代已传到地中海东部地区。那时食用其嫩叶而非未成熟花头。其花供食用的类型最早于1400年左右见于意大利的纪录。洋蓟广泛种植于加利福尼亚、法国、西班牙、比利时、地中海附近各国及其他土壤肥沃、气候温和潮湿的地区，在中国大陆的陕西省、山东省均有分布。'],
                            '71':[' gazania ','勋章花 ','勋章菊（学名：Gazania rigens Moench）是菊科，勋章菊属多年生草本植物，株高可达40厘米，叶由根际丛生，叶片披针形或倒卵状披针形，叶背密被白毛，叶形丰富。头状花序单生，舌状花和管状花两种，花色丰富多彩，有白、黄、橙红等色，花瓣有光泽，花心处多有黑色、褐色5-10月开花。'],
                            '90':[' canna lily ',' 美人蕉 ','美人蕉（学名：Canna indica L.）：多年生草本植物，高可达1.5米，全株绿色无毛，被蜡质白粉。具块状根茎。地上枝丛生。单叶互生；具鞘状的叶柄；叶片卵状长圆形。总状花序，花单生或对生；萼片3，绿白色，先端带红色；花冠大多红色，外轮退化雄蕊2-3枚，鲜红色；唇瓣披针形，弯曲；蒴果，长卵形，绿色，花、果期3-12月。'],
                            '18':[' peruvian lily ',' 水仙百合 ','六出花（学名：Alstroemeria aurea Graham）是六出花科、六出花属植物。多年生宿根草本，高约1米，根肥厚肉质，平卧土中延长，须根多；茎自根茎上不定芽萌发，直立而细长，叶片多数，互生状散生，披针形，光滑。花序下为一轮生叶，总花梗5，各具花2-3朵，插生于花被片基部；子房下位，3室，具种子多数。'],
                            '98':[' mexican petunia ','蓝花草','蓝花草，学名叫狭叶翠芦莉，也叫竹叶草、鸭跖草、马兰花、马莲、旱蒲、竹叶草等。是爵床科芦莉草属多年生草本宿根植物。单叶对生，线状披针形。花腋生，花冠漏斗状，5裂，具放射状条纹，细波浪状，多蓝紫色，少数粉色或白色。果期由夏到秋，种子细小。'],
                            '8':[' bird of paradise ','鹤望兰','鹤望兰（学名：Strelitzia reginae），又称天堂鸟或极乐鸟花，为鹤望兰科鹤望兰属物种，是原产南非的一种单子叶植物。它们学名是为纪念英王乔治三世王妃夏洛特皇后而取的。'],
                            '30':['sweet william ','美国石竹 ','美国石竹（学名：Dianthus barbatus L.）是石竹科，石竹属多年生草本植物，高可达60厘米，全株无毛。茎直立，叶片披针形，顶端急尖，基部渐狭，中脉明显。花多数，集成头状，有数枚叶状总苞片；花梗极短；苞片卵形，顶端尾状尖，边缘膜质，花萼筒状，裂齿锐尖；花瓣具长爪，瓣片卵形，；雄蕊稍露于外；子房长圆形，花柱线形。蒴果卵状长圆形，种子褐色，扁卵形，5-10月开花结果。'],
                            '17':['purple coneflower ','松果菊 ','松果菊（学名：Echinacea purpurea (Linn.) Moench）是菊科松果菊属植物，多年生草本植物。高50-150厘米，全株有粗毛，茎直立；叶缘具锯齿。基生叶卵形或三角形，茎生叶卯状披针形，叶柄基部略抱茎。头状花序，单生或多数聚生于技顶，花大，直径可达10厘米：花的中心部位凸起，呈球形，球上为管状花，橙黄色；种子浅褐色，外皮硬。花期夏秋。'],
                            '52':['wild pansy ',' 三色堇 ','三色堇（学名：Viola tricolor L.）是堇菜科堇菜属的二年或多年生草本植物。基生叶叶片长卵形或披针形，具长柄，茎生叶叶片卵形、长圆形或长圆披针形，先端圆或钝，边缘具稀疏的圆齿或钝锯齿。'],
                            '84':['columbine ',' 耧斗菜','耧斗菜，拉丁学名：（Aquilegia viridiflora Pall.），为双子叶植物纲、毛茛科、耧斗菜属下的一个植物种。原产于欧洲和北美。为多年生草本植物，根肥大，圆柱形，粗达1.5厘米，简单或有少数分枝，外皮黑褐色。根出叶，叶表面有光泽，背面有茸毛，在6、7月间开花，通常深蓝紫色或白色，花药黄色，供药用。'],
                            '12':['colts foot ','款冬','款冬（学名：Tussilago farfara L.）是菊科款冬属植物。多年生草本。根状茎横生地下，褐色。早春花叶抽出数个花葶，高5-10厘米，密被白色茸毛，有鳞片状，互生的苞叶，苞叶淡紫色。头状花序单生顶端，直径2.5-3厘米，初时直立，花后下垂。瘦果圆柱形，长3-4毫米；冠毛白色，长10-15毫米。后生出基生叶阔心形，具长叶柄，叶片长3-12厘米，宽4-14-厘米。'],
                            '11':['snapdragon ','金鱼草','金鱼草（学名：Antirrhinum majus L.）是玄参科、金鱼草属植物。 [7]  多年生直立草本，茎基部有时木质化，高可达80厘米。茎基部无毛，中上部被腺毛，基部有时分枝。叶下部的对生。总状花序顶生，密被腺毛；花梗长5-7毫米；花萼与花梗近等长，5深裂，裂片卵形，钝或急尖；雄蕊4枚，2强。蒴果卵形，长约15毫米，基部强烈向前延伸，被腺毛，顶端孔裂。'],
                            '96':['camellia ','山茶','山茶（学名：Camellia japonica L. ）：是双子叶植物纲山茶科植物。灌木或小乔木，高约9米，嫩枝无毛。叶革质，椭圆形，先端略尖，基部阔楔形，上面深绿色，干后发亮，无毛，下面浅绿色。花顶生，红色，无柄；苞片及萼片约10片，花瓣6-7片，外侧2片近圆形。蒴果圆球形，直径2.5-3厘米，2-3室，每室有种子1-2个，3爿裂开，果爿厚木质。花期1-4月。'],
                            '23':['fritillary ','贝母','贝母，（学名：Fritillaria sinica S. C. Chen），是百合目、百合科、贝母属的植物。'],
                            '50':['common dandelion ',' 药用蒲公英 ','药用蒲公英（学名：Taraxacum officinale）是多年生草本植物，长4-20厘米，宽10-65毫米。生长于海拔700-2200米间的低山草原、森林草甸或田间与路边。分布于新疆、哈萨克斯坦、吉尔吉斯斯坦及欧洲、北美洲等地。'],
                            '44':['poinsettia ',' 一品红','一品红（学名：Euphorbia pulcherrima Willd. et Kl.）是隶属于大戟科、大戟属的灌木。根圆柱状，极多分枝。茎直立，高1-3米，直径1-4 厘米，无毛。叶互生，卵状椭圆形、长椭圆形或披针形，绿色，边缘全缘或浅裂或波状浅裂，叶面被短柔毛或无毛，叶背被柔毛；苞叶5-7枚，狭椭圆形，长3-7厘米，宽1-2厘米，通常全缘，极少边缘浅波状分裂，朱红色。花序数个聚伞排列于枝顶；总苞坛状，淡绿色，边缘齿状5裂，裂片三角形，无毛。蒴果，三棱状圆形，平滑无毛。'],
                            '53':['primula ',' 报春花','报春花 （Primula malacoides Franch.）：报春花科报春花属二年生草本植物，通常被粉，叶簇生，叶片卵形至椭圆形或矩圆形，裂片具不整齐的小牙齿，叶柄被多细胞柔毛。花葶高可达40厘米，伞形花序，苞片线形或线状披针形，花梗纤细，花萼钟状，花冠粉红色，淡蓝紫色或近白色，蒴果球形，2-5月开花，3-6月结果。'],
                            '72':['azalea ',' 映山红 ','杜鹃（学名：Rhododendron simsii Planch.）：是双子叶植物纲、杜鹃花科、杜鹃属的常绿灌木、落叶灌木 [1]  。又名映山红、山石榴。相传，古有杜鹃鸟，日夜哀鸣而咯血，染红遍山的花朵，因而得名。杜鹃花一般春季开花，每簇花2-6朵，花冠漏斗形，有红、淡红、杏红、雪青、白色等，花色繁茂艳丽。生于海拔500-1200（-2500）米的山地疏灌丛或松林下，为中国中南及西南典型的酸性土指示植物。'],
                            '65':['californian poppy ','花菱草','花菱草，（学名：Eschscholtzia californica Cham.），为罂粟科多年生草本植物，常作一、二年生栽培。耐寒力较强，喜冷凉干燥气候、不耐湿热，炎热的夏季处于半休眠状态，常枯死 ，秋后再萌发。'],
                            '80':['anthurium ',' 花烛','花烛属，上升或匍匐草本，或为攀援灌木。叶形各式，全缘或浅裂，深裂或掌状分裂；叶柄明显，基部具短鞘，先端有膨大的关节，花序柄大都伸长，稀很短。产热带美洲，现各热带地区常有栽培，我国引入有花烛A. andraeanum Lind. 等2种，见于福建、广东和云南，供观赏。'],
                            '76':['morning glory ',' 牵牛花 ','牵牛（Ipomoea nil (Linnaeus) Roth [2]  ）是旋花科、牵牛属，一年生缠绕草本 [1]  。这一种植物的花酷似喇叭状，因此有些地方叫它喇叭花。种植牵牛花一般在春天播种，夏秋开花，其品种很多，花的颜色有蓝、绯红、桃红、紫等，亦有混色的，花瓣边缘的变化较多，是常见的观赏植物。果实卵球形，可以入药。牵牛花叶子三裂，基部心形。花呈白色、紫红色或紫蓝色，漏斗状，全株有粗毛。花期以夏季最盛。种子具有药用价值。'],
                            '37':['cape flower ','孤挺花属','孤挺花属（Amaryllis） 是石蒜科孤挺花族孤挺花亚族（Amaryllidinae）的唯一一个属，是一类小型开花植物，下共二种，其中比较出名的是原产于南非西开普的南非孤挺花（Amaryllis belladonna）[1]，这一一种较常见的观赏植物。'],
                            '56':['bishop of llandaff ',' 兰达夫主教 ','大丽花属（学名：Dahlia）是菊科的一个属，分布于拉丁美洲。'],
                            '60':['pink-yellow dahlia ','大丽花属','大丽花属（学名：Dahlia）是菊科的一个属，分布于拉丁美洲。'],
                            '82':['clematis ',' 铁线莲','铁线莲（Clematis florida Thunb.），别名铁线牡丹、番莲、金包银、山木通、番莲、威灵仙；为毛茛科 、铁线莲属植物，多数为落叶或常绿草质藤本，花期从早春到晚秋（也有少数冬天开花的品种），果期夏季。有若干个种、变种及其品种和杂交种，可栽培供园林观赏用。铁线莲享有“藤本花卉皇后”之美称，花期6~9月，花色一般为白色，花有芳香气味， 铁线莲可作展览用切花，可用于攀缘常绿或落叶乔灌木上，可用作地被；以根及全草入药。利尿，理气通便，活血止痛。用于小便不利，腹胀，便闭；外用治关节肿痛，虫蛇咬伤。'],
                            '58':['geranium ',' 天竺葵;老鹳草 ','天竺葵（学名：Pelargonium hortorum ），别名洋绣球、石腊红、入腊红、日烂红、洋葵，属牻牛儿苗科，包括约230种多年生肉质、亚灌木或灌木植物。天竺葵原产非洲南部，世界各地普遍栽培。'],
                            '75':['thorn apple ','曼陀罗花 ','曼陀罗花又叫洋金花、大喇叭花、山茄子、夕颜、醉心花、狗核桃、醉仙桃等，果实名为：狗核桃、毛苹果。为茄科曼陀罗属、一年生直立草本植物，原产印度，现广泛分布全球，我国各地均有野生或栽培，主产在华南地区，以广西最多。花期6－8月 [1]  ，果期6－10月，喜温暖、向阳及排水良好的砂质壤土。多野生在田间、沟旁、道边、河岸、山坡等地方，主要危害棉花、豆类、薯类、蔬菜等，有剧毒。'],
                            '41':['barbeton daisy ','雏菊','雏菊（学名：Bellis perennis）是菊科雏菊属的一种，别名长命菊、延命菊，原产于欧洲，原种被视为丛生的杂草，开花期在春季。'],
                            '95':['bougainvillea ',' 叶子花','叶子花（学名：Bougainvillea spectabilis Willd.），紫茉莉科，叶子花属木质藤本状灌木，茎有弯刺，并密生绒毛。单叶互生，卵形全缘，被厚绒毛，顶端圆钝。花很细小，黄绿色，三朵聚生于三片红苞中，外围的红苞片大而美丽，有鲜红色、橙黄色、紫红色、乳白色等，被误认为是花瓣，因其形状似叶，故称其为叶子花。花期可从11月起至第二年6月。冬春之际，姹紫嫣红的苞片展现，给人以奔放、热烈的感受，因此又得名贺春红。'],
                            '43':['sword lily ',' 剑兰','剑兰，学名为唐菖蒲，是鸢尾科球根植物。'],
                            '83':['hibiscus ',' 木槿 ','木槿（学名：Hibiscus syriacus Linn.）：落叶灌木，高3-4米，小枝密被黄色星状绒毛。叶菱形至三角状卵形，长3-10厘米，宽2-4厘米，具深浅不同的3裂或不裂，先端钝，基部楔形，边缘具不整齐齿缺，下面沿叶脉微被毛或近无毛。花单生于枝端叶腋间，花萼钟形，长14-20毫米，密被星状短绒毛，裂片5，三角形；花朵色彩有纯白、淡粉红、淡紫、紫红等，花形呈钟状，有单瓣、复瓣、重瓣几种。外面疏被纤毛和星状长柔毛。蒴果卵圆形，直径约12毫米，密被黄色星状绒毛；种子肾形，背部被黄白色长柔毛。花期7-10月。'],
                            '78':['lotus lotus ','百脉根属','百脉根属（学名：Lotus）是蝶形花科下的一个属，为多年生草本或小灌木植物。该属共有约60种，分布于欧洲、亚洲、南非和大洋洲。'],
                            '88':['cyclamen ',' 仙客来','仙客来（Cyclamen persicum Mill.），别名萝卜海棠、兔耳花、兔子花、一品冠、篝火花、翻瓣莲，是报春花科、仙客来属多年生草本植物，叶片由块茎顶部生出，心形、卵形或肾形，叶片有细锯齿，叶面绿色，具有白色或灰色晕斑，叶背绿色或暗红色，叶柄较长，红褐色。'],
                            '94':['foxglove ',' 洋地黄','毛地黄（学名：Digitalis purpurea L）是玄参科、毛地黄属一年生或多年生草本植物。除花冠外，全体被灰白色短柔毛和腺毛，有时茎上几无毛，高60-120厘米。茎单生或数条成丛。 茎直立，少分枝，全株被灰白色短柔毛和腺毛；叶基生，莲座状，为卵圆形或卵状披针形，叶缘有圆锯齿，叶柄具狭翅，叶形由下至上渐小；花朵有粉红色和蜡紫红色，顶生，总状花序，花冠钟形，内有浅白边缘的深紫红色斑点，雄蕊有四枚，果实为蒴果。'],
                            '81':['frangipani ',' 鸡蛋花树','鸡蛋花树（学名：鸡蛋花，拉丁学名：Plumeria rubra L. Acutifolia）为夹竹桃科鸡蛋花属落叶小乔木，高约5米，最高可达8米，胸径15-20厘米；枝条粗壮，带肉质，具丰富乳汁，绿色，无毛。叶厚纸质，长圆状倒披针形或长椭圆形。花期5-10月，果期栽培极少结果，一般为7-12月。我国广东、广西、云南、福建等省区有栽培，在云南南部山中有逸为野生的。原产墨西哥；现广植于亚洲热带及亚热带地区。'],
                            '74':['rose ',' 玫瑰','玫瑰（英文名称：rose [16]  ）：是蔷薇目，蔷薇科、蔷薇属多种植物和培育花卉的通称名字。直立、蔓延或攀援灌木，多数被有皮刺、针刺或刺毛，稀无刺，有毛、无毛或有腺毛。叶互生；花单生；花托球形、坛形至杯形；花瓣5，稀4，开展，覆瓦状排列，白色、黄色，粉红色至红色；花柱顶生至侧生，外伸，离生或上部合生；花瓣倒卵形，重瓣至半重瓣，花有紫红色、黄色、粉色、白色和各种复色。枝条较为柔弱软垂且多密刺，每年花期只有一次。'],
                            '89':['watercress ',' 水田芥','水田（watercress）又名水芥菜或西洋菜也为豆瓣菜，属十字花科多年生植物，学名为Nasturtium officinale，原产欧亚，已在北美归化。生长于凉爽的溪流中，沈水、浮在水上或平铺在泥地表面。常用大桶栽培采其嫩梢作沙拉。叶纤细，淡绿色，有胡椒味，富含维生素C。花白色。角果小，豆荚状。种子成两行。扦插易生根。'],
                            '73':['water lily ',' 睡莲 ','睡莲（学名：Nymphaea L.）是睡莲科睡莲属植物统称。多年生浮叶型水生草本植物，根状茎肥厚，直立或匍匐。叶二型，浮水叶浮生于水面，基部深裂成马蹄形或心脏形，叶缘波状全缘或有齿；沉水叶薄膜质，柔弱。花单生，花有大小与颜色之分，浮水或挺水开花；萼片4枚，花瓣、雄蕊多。果实为浆果，在水中成熟，不规律开裂；种子深绿或黑褐色，为胶质包裹，有假种皮。'],
                            '46':['wallflower ',' 桂竹香','桂竹香（学名：Erysimum × cheiri (L.) Crantz）是十字花科糖芥属植物，多年生草本，高20-60厘米；茎直立，具棱角，下部木质化，具分枝，全体有贴生长柔毛。基生叶莲座状，倒披针形、披针形至线形，顶端急尖，基部渐狭；叶柄长7-10毫米；茎生叶较小，近无柄。总状花序果期伸长；花桔黄色或黄褐色，芳香；花梗长4-7毫米；萼片长圆形；花瓣倒卵形，有长爪。长角果线形，直立；果梗上升；种子卵形，浅棕色，顶端有翅。花期4-5月，果期5-6月'],
                            '77':['passion flower ',' 西番莲 ','西番莲（学名：Passiflora caerulea L.）是多年生常绿攀缘木质藤本植物，是一种芳香可口的水果，有“果汁之王”的美誉。又名受难果、巴西果、藤桃、热情果、转心莲、西洋鞠，转枝莲、洋酸茄花，时计草。'],
                            '51':['petunia ',' 矮牵牛 ','碧冬茄（学名：Petunia hybrida Vilm.）是茄科，碧冬茄属一年生草本植物，高可达60厘米，叶片卵形，顶端急尖，侧脉不显著，花单生于叶腋，裂片条形，顶端钝，果时宿存；花冠白色或紫堇色，有各式条纹，漏斗状，花柱稍超过雄蕊。蒴果圆锥状，种子极小，近球形，褐色。'],
                            '102': ['Not Found', '不在识别范围内','匹配度低，不在识别范围内。请确保拍摄的目标是花朵'],
                            }


    def forward(self, filename):
        with torch.no_grad():
            img = Image.open(filename)
            x = self.transform(img)
            x = x.unsqueeze(0)
            x = x.to(self.device)
            out = self.model(x)
            out = torch.softmax(out, dim=1)
            suitability = out.max().item()
            if suitability<self.threshold:
                pred = 102
            else:
                pred = out.max(1, keepdim=True)[1].item()
            return pred, self.flower_name[str(pred)]

    def ROI(self, src, resize_parameter=0.5):
        '''
        # 自动获取中间的ROI区域
        :param src: 输入图片
        :param resize_parameter: 中心ROI的大小
        :return:
        '''
        height, width, layer = src.shape
        # 图片中心x_center=(x_c,y_c)
        x_c, y_c = width / 2, height / 2

        # ROI的长宽占图像的resize_parameter倍
        w = int(width * resize_parameter)
        h = int(height * resize_parameter)

        x_min = int(x_c - w / 2)
        y_min = int(y_c - h / 2)

        # roi区域 r=(x_min, y_min, w, h)
        roi = src[y_min:y_min + h, x_min:x_min + w]

        return roi


    def predict(self, filename):
        pred, flower_info = self.forward(filename)
        flower_name = flower_info[1]
        describe = flower_info[2]
        url = str(pred)+".jpg"
        return flower_name, describe,url